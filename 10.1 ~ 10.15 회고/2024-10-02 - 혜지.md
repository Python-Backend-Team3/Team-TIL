# ☑️ 10월 2일 회고

# ✅ CNN(Convolutional Neural Network) 모델

## 1. CNN 모델의 구조와 이해
### 1-1. CNN 모델이란?
- **영상 인식, 처리 분야에 있어서 가장 기본이 되는 모델**로 눈과 뇌에서 처리되는 신경과학적 시각처리 방식에서 고안한 모델
  
- 신경망 동작을 처리하기 위하여 **합성곱 연산**을 이용하여 가중치 수를 줄임 → 연산량 감소와 효과적인 이미지 처리 수행

- Convolution Filter 를 이용하여 신경망 동작 수행

- Convolution Layer 와 Fully Connected Layer 를 중심으로 영상정보 처리

- Convolution Layer : 특징점을 효과적으로 찾는 데 활용

- Fully Connected Layer : 발견한 특징점을 기반으로 이미지를 분류하는 데 활용

### 1-2. Convolution(합성곱)
- 합성곱 : 두 개의 함수가 있을 때, 둘 중에서 하나의 함수를 반전, 이동(전이)시킨 후, 두 함수를 곱한(결합한) 결과를 적분하여 그 파형(그래프)을 얻는 연산 방법
  ![image](https://github.com/user-attachments/assets/60fc08f1-6e11-4d83-ba28-085441d1bd32)

- 합성곱 신경망에서는 “하나의 함수가 다른 함수와 얼마나 일치하는가?”의 의미로 사용
- 하나의 필터(커널)에 대하여 이미지의 각 부분들이 필터와 얼마나 일치하는지 계산
  ![image](https://github.com/user-attachments/assets/05ad754b-676e-44f7-ac1d-8466067f5166)

### 1-3. CNN 모델의 기본 구조
![image](https://github.com/user-attachments/assets/d9578a00-eca7-4509-a884-9a364c7eff19)

- Convolution Layer - Pooling Layer의 반복

- 반복 방식은 사용자가 임의로 결정 (예: Convolution Layer만 여러 층을 가진 후 마지막에 Pooling Layer가 오는 경우도 있음)

- 국소/지역 콘트라스트 정규화 (Local Contrast Normalization, LCN) 층을 매치하는 경우도 있음

### 1-4. Convolution Layer (합성곱 층)

#### 1-4-1. Convolution Layer (합성곱 층) 
- 목적 : 테두리, 선, 색 등 이미지의 시각적 특징이나 특성 감지
![image](https://github.com/user-attachments/assets/c486665f-28da-400a-a081-03396de0c310)

- 입력 계층과 은닉계층이 1:1 매핑되지 않음

- 시각피질의 수용야에 해당하는 윈도우는 정해진 크기만큼 좌표를 이동하며 입력계층의 데이터를 탐색함
  - 수용야 : 정보 처리에 관여하는 세포에 대하여 응답을 일으키는 자극의 영역

- 픽셀 차이를 입력 계층과 겹쳐가며 이동하는데 이 간격을 스트라이드라고 함

- 필터의 크기(윈도우)가 5x5=25 인 경우는 25개의 픽셀이 하나의 뉴런에 대응됨

#### 1-4-2. 패딩
- 더 좋은 결과를 내기 위하여 윈도우를 이미지 영역 밖으로 확장할 때 사용
![image](https://github.com/user-attachments/assets/53bb2cc7-d23e-467f-b395-2dfc4e524795)

#### 1-4-3. Convolution Layer 에서의 연산
- Convolution, 즉 합성곱이란 이미지와 필터 사이에 정의되는 합성 곱 연산을 말함

- 이미지의 합성곱은 필터의 명암 패턴과 유사한 명암 패턴이 입력된 이미지의 어디에 있는지 검출하는 작용, 즉 필터가 나타내는 특징적인 명암 구조를 이미지로부터 추출하는 작용을 함
  
- 필터: 커널이라고도 함
  - 입력층의 윈도우를 은닉층의 뉴런 하나로 압축할 때, Convolution Layer에서는 윈도우의 크기만큼의 가중치와 1개의 편향 값(bias)을 적용
  - 예를 들어 윈도우의 크기가 5x5라면 5x5개의 가중치와 1개의 편향 값이 필요함
  - 이 5x5개의 가중치와 1개의 편향 값을 커널, 또는 필터라고 부름
  - 필터는 해당 은닉층을 만들기 위한 모든 윈도우에 공통으로 적용됨

#### 1-4-4. 필터 사용의 장단점
- 장점
  - 가중치의 수를 줄임으로써 전체 연산량을 대폭 감소시킬 수 있음
  - ex) 입력층의 크기가 28x28 일때 기본 신경망의 경우 28x28=784 개의 가중치를 찾아야 하지만 Convolution Layer 에서는 5x5 개인 25 개의 가중치만 찾으면 됨

- 단점
  - 복잡한 특징을 가진 이미지의 분석이 어려움
  - 보완책으로서 여러 개의 필터를 사용하며, 분석하고자 하는 내용에 따라 필터의 개수를 어떻게 정하는가 하는 것이 중요함

### 1-5. Pooling Layer (전달층)
- Convolution Layer 와 Pooling Layer 의 관계 및 역할
  - 이미지 데이터, 즉 2 차원의 평면 행렬에서 지정한 영역의 값들을 하나의 값으로 압축
  - 압축할 때
    - Convolution Layer: 가중치와 편향을 적용
    - Pooling Layer: 값들 중 하나를 선택해서 가져오는 역할
![image](https://github.com/user-attachments/assets/23327c62-5cdd-4d88-bd05-2fb874b6b9f6)

### 1-6. LCN (Local Contrast Normalization)
- 국소 콘트라스트(대비) 정규화
  - 자연물 이미지 등 주변의 조명, 카메라의 노출 등 환경 변화에 따라 이미지 전체의 밝기, 대비가 크게 변하는 경우 사용함

  - 이미지 밝기 정규화의 방법
    - 이미지의 집합(훈련 데이터)에 대한 통계치를 이용하여 이미지의 명암을 전체적으로 조절
    - LCN
      - 이미지 한 장, 한 장에 대하여 개별적으로 조절
      - 고정된 가중치를 사용하므로 학습 가능한 파라미터는 없음

### 1-7. Fully Connected Layer (완전연결층)
- 일반적으로 기존의 신경망에서 각 층별 연결에 사용되는 방식. 전결합층

- 모든 노드를 연결하므로 수많은 연산이 일어남

- CNN 의 특징은 모든 노드를 결합하지 않음으로써 연산량을 줄여 효율성을 높이는 방식

- 사용 이유
  - 모든 노드를 연결하므로 1차원배열로 표시됨 ➜ 이미지의 공간정보가 사라짐
  - 최종 결과값은 분류 결과 도출 → 결국 마지막에 도출된 분류결과 Label을 선택하여야 함
  - 최종 결과를 분류하기 위한 기반 정보는 모두 가지고 있어야 분류를 위한 SoftMax 함수를 사용할 수 있음

- 필수는 아니며 Convolution Layer 의 결과를 그대로 사용할 수도 있음

### 1-8. SoftMax
- 활성화 함수
  - 실제 신경망에서는 우리 몸에서 반응할 필요가 있는 수준 까지만 신호를 전달하고 나머지의 신호는 무시 → 비선형적 특징
  - 합성곱 연산은 입력과 가중치로 이루어진 연산 → 선형성을 가짐 → 비선형 특성 부여를 위하여 활성화 함수가 필요함
  - 최근 많이 사용되는 활성화 함수는 ReLU(Rectified Linear Unit) 계열의 함수
![image](https://github.com/user-attachments/assets/a832fc55-bb28-45ec-b87a-15765812c16b)

### 1-9. CNN 전체 구조의 예시
![image](https://github.com/user-attachments/assets/da8bc443-3291-430b-b93c-ebdd3da5c00c)
<br><br/>

## 2. 뇌의 시각정보 처리 과정과 CNN 모델

### 2-1. CNN 모델의 구상
- 눈과 시각피질 사이의 시각정보 처리 방식에서 개념 도입
  - 망막에서의 빛 인식 영역 → 입력층
  - 시각피질의 단순세포에 의한 입력패턴 대응 영역 → 중간층
  - 시각피질의 복합세포에 의한 활성화 및 차원축소 영역 → 출력층
  - 해당 영역에 대한 수용야(감수영역이라고도 함) → 필터
  - 수용야의 영역 크기 → 윈도우
  - 수용야의 이동 범위 → 스트라이드
  - 수용야의 영역 처리 → 패딩

- 시각 처리 신경망은 단순세포와 복잡세포가 층을 이루어 구성되었고, 층간 연산에 따라 동작하는 것으로 관찰되고 있으며, CNN 모델은 이를 반영하고 있음
![image](https://github.com/user-attachments/assets/6bd61ff8-d993-4f28-8038-50c7b0e38cd5)
<br><br/>

## 3. CNN 모델과 DNN 모델의 차이

### 3-1. CNN 모델과 DNN 모델 비교

#### 공통점
- 동일한 학습 방법을 따름
  - 모든 층에 대하여 추측을 할 때는 Forward Propagation 수행
  - 모든 층에 대한 가중치(Weight)를 훈련할 때는 Back Propagation 수행

#### 차이점
- **DNN 모델**
  - 목적: 입력에 대하여 원하는 결과가 나올 수 있도록 가중치를 갱신(훈련, 학습)하는 것
  - 학습: 각 노드에 대한 가중치를 학습함

- **CNN 모델**
  - 목적: 합성곱(Convolution) 층을 이용하여 유의미한 특징(Feature)을 추출하여 이용하는 것
  - 학습: 각 특징에 대한 가중치를 학습함
<br><br/>

## 4. CNN 모델 기반의 영상 처리

### 4-1. 전통적인 영상처리 방법과의 차이
- 전통적인 영상 처리 방법
  - 수동으로 설계된 특징 추출기를 사용하는데 이는 특징 추출 능력 및 범위 적용에 한계가 있다

- CNN 모델
  - 데이터로부터 직접 특징을 학습 → 더 복잡한 패턴 학습 가능, 다양한 문제에 더 유연하게 적용 가능

### 4-2. 영상 분류 (Image Classification)
![image](https://github.com/user-attachments/assets/71447ab2-d324-4d90-880d-f423df61322b)

- 개념
  - 주어진 이미지가 어떤 카테고리에 속하는지 판단하는 과정
  - 이미지 전체를 한 카테고리로 분류

- 기술적/구조적 특징
  - 영상 분류에서는 이미지 전체를 분석하여 하나의 레이블로 분류함
  - 일반적인 CNN 구조가 사용됨
  - 마지막 출력 층에서 소프트맥스 활성화 함수 등을 사용하여 카테고리별 확률을 계산함

### 4-3. 영상 검출 (Image Detection)
![image](https://github.com/user-attachments/assets/82666dc3-2725-4b43-ad70-725c5b491591)

- 개념
  - 주어진 이미지에서 어떤 객체가 어떤 위치에 존재하는지를 파악하여 해당 영역의 카테고리를 할당하는 작업
  - 이미지 내 객체의 위치와 카테고리를 동시에 찾음

- 기술적/구조적 특징
  - 검출은 이미지 내의 여러 객체를 찾아야 하므로, 로컬 영역에서의 패턴을 파악해야 함
  - YOLO, SSD와 같은 특수한 구조를 사용하여 객체의 경계 상자와 함께 클래스 레이블을 예측

### 4-4. 영상 영역 분할 (Image Segmentation)
![image](https://github.com/user-attachments/assets/5ad38716-dc51-4525-ac9c-84ba9ec5cf65)

- 개념
  - 이미지의 각 픽셀이 어떤 카테고리에 속하는지 판단하는 작업
  - 이미지의 각 픽셀 별로 카테고리 할당

- 기술적/구조적 특징
  - 이미지의 각 픽셀에 레이블을 할당해야 하므로, 공간 정보를 잘 보존해야 함
  - U-Net과 같은 구조가 사용됨
  - 업샘플링과 다운샘플링을 통해 고해상도의 세그멘테이션 맵을 생성함

### 4-5. 영상 복원(Image Restoration)
![image](https://github.com/user-attachments/assets/ce708d32-11e0-4e6f-bf43-d97efee4c430)

- 개념
  - 영상 복원은 손상된 또는 왜곡된 이미지를 복원하는 작업 (노이즈 제거, 해상도 향상 등)
  - 손상된 이미지 복원

- 기술적/구조적 특징
  - 원래 이미지의 특성을 복구해야 하므로, 손실함수와 네트워크 구조가 복잡할 수 있음
  - SRCNN, GAN 등의 고급 기술을 사용하여 이미지의 본래 특성을 복원함
  - 현실성과 엄격한 데이터 일관성을 갖춘 임의의 척도에 대하여 강력한 지원을 보여줌

![image](https://github.com/user-attachments/assets/f5d5c360-f543-4120-b22b-d09c46512583)















