# 📌 9월 19일 회고

# ✍️ 테스트 주도 개발 방법론

## 1. 테스트 주도 개발(TDD) 개요
### 1.1 TDD?
- 코드를 작성하기 전에 테스트 케이스를 먼저 작성하는 방식을 따르는 소프트웨어 개발 방법론 중 하나
    - 개발 과정을 짧은 반복 주기로 나누고 각 주기마다 사용자의 요구 사항을 테스트 케이스로 변환하여 코드를 개선해 나가는 방식

- TDD를 개발한 켄트 백(애자일 방법론의 개발자)은 2003년에 “TDD는 단순한 설계를 촉진시켜주며 자신감을 불어 넣어준다” 라고 말한 바가 있음

- 애자일 방법론 중 하나인 eXtream Programming(XP)의 'Test-First' 개념에 기반을 둔 단순한 설계를 중요시 함
    - 애자일 방법론
        - 신속한 반복 작업을 통해 실제 작동 가능한 소프트웨어를 개발하여 지속적으로 제공하기 위한 소프트웨어 개발 방식
        - 작동하는 소프트웨어의 작은 구성 요소를 신속하게 제공하여 고객의 만족도를 개선하는 것이 핵심
        - 적응형 접근 방식과 팀워크를 활용한 지속적인 개발에 중점
        - 소프트웨어 개발에 필요한 작업을 알려주는 일련의 규정이 아니라, 협업과 워크플로우를 바라보는 하나의 관점이며, 우리가 무엇을 어떻게 만들지에 관한 선택을 안내하는 가치 체계를 가리킴

    - eXtream Programming(XP)
        - 미래에 대한 예측을 최대한 하지 않고, 지속적으로 프로토타입을 완성하는 애자일 방법론 중 하나
        - 이 방법론은 추가 요구사항이 생기더라도, 실시간으로 반영할 수 있음

- 목적
    - 코드의 품질 향상
    - 유지보수 용이
    - 개발자의 생산성을 높이는 데 도움을 줌
    - 설계 오류를 초기에 발견, 수정할 수 있게 지원
    - 개발 과정에서의 오류와 리스크를 줄이기 위해 고안됨

- TDD의 핵심
    - 실패하는 테스트 케이스를 먼저 작성하고 테스트를 통과하기 위한 최소한의 코드만을 작성하는 것
<br><br/>

### 1.2 TDD의 적용 단계

#### 1.2.1 실패하는 테스트 작성

- 구현할 기능에 대한 작은 단위의 테스트 케이스를 먼저 작성
- 요구사항을 충족시키지 못하는 테스트 케이스를 작성함
- 이 단계에서는 기능이 어떻게 동작해야 하는지 명확히 정의함 ⇒ 개발해야 할 기능의 명세서 역할 수행
  
#### 1.2.2 테스트를 통과하는 코드 작성

- 테스트를 통과하기 위한 최소한의 코드를 작성
- 이 단계에서는 코드의 품질이 아니라 테스트를 통과하는 것에만 집중함
  
#### 1.2.3 리팩토링

- 테스트를 통과한 코드를 개선
- 이 단계에서는 코드의 품질 향상에 집중함
    - 코드의 가독성 향상
    - 중복된 코드 제거
    - 필요 시 설계 개선
    - 유지보수성 개선
      
#### 1.2.4 점진적 코드 개선
- 1~3단계를 반복하여 점진적 코드 개선 추구
<br><br/>

### 1.3 TDD의 장단점

#### 1.3.1 장점
- 빠른 피드백
    - 코드가 작성되기 전에 테스트가 준비되므로, 코드 작성 후 바로 피드백을 받을 수 있음
    - 개발 과정에서의 버그를 사전에 예방할 수 있음
    - 개발 과정에서의 리스크를 줄일 수 있음
    - 개발자의 생산성 향상에 기여함
      
- 높은 코드 품질
    - 테스트를 먼저 작성함으로써 코드의 품질을 높일 수 있음
      
- 유지보수 용이
    - 테스트 케이스가 존재하므로, 코드 변경 시에도 기존 기능이 정상적으로 동작하는지 쉽게 확인할 수 있음
 
#### 1.3.2 단점
- 초기투자 필요
    - TDD를 적용하는 데에는 시간과 노력이 필요함
    - 초기 학습 곡선이 가파를 수 있음
      
- 생산성의 저하
    - 개발 속도가 느려진다고 생각하는 사람이 많기 때문에 TDD에 대해 반신반의함
        - 처음부터 2개의 코드를 짜야함
        - 중간중간 테스트를 하면서 고쳐나가야 함
    - TDD 방식의 개발 시간은 일반적인 개발 방식에 비해 대략 10~30% 정도로 늘어남
    - SI 프로젝트에서는 소프트웨어의 품질보다 납기일 준수가 훨씬 중요하다 생각하기 때문에 TDD 방식을 잘 사용하지 않음
      
- 사전 경험(충분한 연습과 경험)이 중요함
    - 모든 상황에 TDD를 적용하기 어려울 수도 있음
    - 테스트 케이스 작성에 대한 경험이 부족한 개발자에게는 도전적인 작업일 수 있음
      
- 기존 개발방식의 변경이 요구됨
    - 이제까지 자신이 개발하던 방식을 많이 바꿔야 함
    - 몸에 체득한 것이 많을 수록 바꾸기가 어려움
    - 오히려 개발을 별로 해보지 않은 사람들에겐 적용하기가 쉬움
      
- 구조에 얽매임
    - TDD로 프로젝트를 진행하면서 어려운 예외가 생길 수 있는데 그것 때문에 고민하는 순간이 찾아옴
    - 원칙을 깰 수는 없고 꼼수가 있기는 한데 그 꼼수를 위해서 구조를 바꾸자니 이건 아무래도 아닌 것 같고, 테스트는 말 그대로 테스트일 뿐 실제 코드가 더 중요한 상황인데도 불구하고 테스트 원칙 때문에 쉽게 넘어가지 못하는 경우 등
      
- 개발자는 TDD에 대한 지속적인 학습과 실습을 통해 이 방법론을 자신의 개발 과정에 효과적으로 통합해야 함
<br><br/>

### 1.4 TDD의 효과

#### 1.4.1 디버깅 시간의 단축
- 유닛 테스팅을 하는 이점
    - 사용자의 데이터가 잘못 나온다면 DB의 문제인지, 비즈니스 레이어의 문제인지, UI의 문제인지 바로 알 수 없기때문에 실제 모든 레이어들을 전부 디버깅 해야함
    - TDD의 경우 자동화 된 유닛테스팅을 전재하므로 특정 버그를 손 쉽게 찾아낼 수 있음

#### 1.4.2 가장 빠른 피드백
- 개발 프로세스에서는 보통 '인수 테스트'를 수행함
    - 인수 테스트: 이미 배치된 시스템을 대상으로 클라이언트가 의뢰한 소프트웨어가 사용자 관점에서 사용할 수 있는 수준인지 체크하는 과정
- 이미 90% 이상 완성된 코드를 가지고 테스트하기 때문에 문제를 발견할 수는 있지만 정확하게 원인이 무엇인지 진단하기는 어려움
- TDD를 사용하면 기능 단위로 테스트를 진행하기 때문에 코드가 모두 완성되어 프로그래머의 손을 떠나기 전에 빠르게 피드백을 받는 것이 가능함

#### 1.4.3 코드의 불안정성 개선 및 생산성 향상
- 코드가 내 손을 떠나 사용자에게 도달하기 전에 문제가 없는지 먼저 진단 받을 수 있으므로 코드가 지닌 불안정성과 불확실성을 지속적으로 해소해줌
- 켄트 백은 TDD는 불안함을 지루함으로 바꾸는 마법의 돌이라고 표현

#### 1.4.4 프로그래머의 오버 엔지니어링 방지
- 프로그래머들은 간혹 계획하지 않았던 코드를 추가하여 오버 엔지니어링하는 경우가 있음
    - TDD의 원칙: 테스트를 통과하기 위한 최소한의 코드만 작성 및 개선해야 함
- 기능 단위로 테스트를 진행하기 때문에, 문제가 발견되지 않은 코드에 영향을 줄 수 있는 오버 코딩은 하지 않을 수 있음

#### 1.4.5 개발 이력의 활용
- TDD를 사용하면 개발 과정이 테스트 코드로 남기 때문에, 과거 의사결정을 쉽게 상기할 수 있다.
    - TDD를 사용하면, 테스트 코드를 작성하는 과정에서 히스토리가 남음 ⇒ 어떻게 보면 과거의 나 자신과 프로그래머가 협업하는 것을 용이하게 만들어준다고 할 수 있음
    - TDD를 통해 작성한 테스트 코드를 트래킹하면서 과거에 어떤 인과관계로 의사결정을 했는지 확인하기 쉬움

#### 1.4.6 재설계 시간의 단축
- 테스트 코드를 먼저 작성하기 때문에 개발자가 지금 무엇을 해야하는지 분명히 정의하고 개발을 시작하게 됨
- 또한 테스트 시나리오를 작성하면서 다양한 예외사항에 대해 생각해볼 수 있음
- 이는 개발 진행 중 소프트웨어의 전반적인 설계가 변경되는 일을 방지할 수 있음

#### 1.4.7 추가 구현이 용이함
- 개발이 완료된 소프트웨어에 어떤 기능을 추가할 때 가장 우려되는 점은 해당 기능이 기존 코드에 어떤 영향을 미칠지 알지 못한다는 것임
- TDD의 경우 자동화된 유닛 테스팅을 전제하므로 테스트 기간을 획기적으로 단축시킬 수 있음
<br><br/>

### 1.5 일반 개발 방식 vs. TDD 개발 방식

#### 1.5.1 일반 개발 방식

- 개발 주기
    - 요구사항 분석 → 설계 → 개발 → 테스트 → 배포
<img src="https://github.com/aidalabs/Lectures/blob/main/LectureFiles/images/Web_016_TDD_001.png?raw=true"> 

- 소프트웨어의 개발을 느리게 하는 잠재적인 위험 존재
    - 소비자의 요구사항이 처음부터 명확하지 않을 수 있음 → 처음부터 완벽한 설계는 어려움
    - 자체 버그 검출 능력 저하 또는 소스코드의 품질 저하 위험 존재
    - 자체 테스트 비용 증가 가능성

- 완전하지 않은 초기 설계에 대한 대응
    - 고객의 요구사항 또는 디자인의 오류 등 많은 외부 또는 내부 조건에 의해, 재설계하여 점진적으로 완벽한 설계로 진행
    - 재설계로 인해 개발자는 코드를 삽입, 수정, 삭제 하는 과정에서 불필요한 코드가 남거나 중복처리 될 가능성이 큼
    - 이러한 코드들은 재사용이 어렵고 관리가 어려워져 유지보수를 어렵게 만듦

- 작은 부분의 기능 수정에도 모든 부분을 테스트해야 하므로 전체적인 버그를 검출하기 어려워짐
    - 자체 버그 검출 능력 저하
    - 결과적으로 어디서 버그가 발생할지 모르기 때문에 잘못된 코드도 고치지 않으려 하는 현상이 나타남
    - 이 현상은 소스코드의 품질 저하과 직결됨
    - 작은 수정에도 모든 기능을 다시 테스트해야 하는 문제로 인해 자체 테스트 비용 증가
      
#### 1.5.2 TDD 개발 방식
- 개발 주기
    - 디자인(설계) → 테스트 코드 작성 → 코드 개발 → 리팩토링 → 반복
      
- 단계별 작업 및 주의사항
    - 디자인(설계) 단계
        - 프로그래밍의 목적을 반드시 미리 정의해야 함
        - 무엇을 테스트해야 할지 미리 정의(테스트 케이스 작성)해야 함
    - 테스트 코드 작성 단계
        - 작성 도중에 발생하는 예외 사항(버그, 수정사항)들은 테스트 케이스에 추가하고 설계를 개선함
        - 테스트 케이스의 작성으로 인해 자연스럽게 설계가 개선됨 → 재설계 시간 절감
    - 코드 개발 단계
        - 테스트를 통과한 코드만을 코드 개발 단계에서 실제 코드로 작성함
    - 리팩토링 단계
        - 좋지 않은 코드를 정리 및 개선
    - 각 단계 반복
        - 이러한 단계가 반복되면서 자연스럽게 코드의 버그가 줄어들고 소스코드는 간결해짐
<img src="https://github.com/aidalabs/Lectures/blob/main/LectureFiles/images/Web_016_TDD_002.png?raw=true">

- Bad Smell
    - 코드에서 발견되는 잠재적인 문제를 나타내는 용어
    - 코드의 품질이 떨어지거나 유지보수가 어려워질 수 있는 징후를 의미
    - 버그는 아니지만, 코드의 설계나 구현이 좋지 않다는 신호로 받아들여짐
    - Bad Smell의 예
        - 중복 코드: 동일한 코드 구조가 여러 곳에 반복되는 경우
        - 긴 메서드: 너무 길고 많은 일을 하는 메서드
        - 큰 클래스: 너무 많은 책임을 가진 클래스
        - 기능 질투: 다른 클래스에 더 관심이 많은 메서드
        - 데이터 덩어리: 함께 전달되는 경향이 있는 데이터 그룹
    - Bad Smell을 해결하기 위해서는 리팩토링이 필요함
        - 리팩토링: 코드의 외부 동작을 변경하지 않으면서 내부 구조를 개선하여 가독성을 높이고 복잡성을 줄이며 유지보수를 쉽게 만드는 과정





















